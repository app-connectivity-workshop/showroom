:imagesdir: ../../assets/images
include::../style.adoc[]



== Module 3: Simplify and secure traffic management with {rhcl}

With their growing popularity, {corp} would like to add new channels to their existing portals. They plan to onboard  partner portals, which require secure access to their core services.

All incoming traffic from the external partner portal needs to be secured and managed. {corp} also wants to protect the endpoints by easily applying rate limiting and specific levels of access based on systems and users.


== Solution 

To expose core services to external partners, {corp} decides to embrace a policy-as-code approach which provides repeatable and automated policy-based management defined security through code.

. Secure access to the core (Travels) services is required for connectivity from the partner portals being onboarded.
. The team adopts a Kubernetes-native approach to application connectivity through {rhcl}.
. Platform Engineers configure a `Gateway` resource to securely expose core services, and set up default `AuthPolicy` and `RateLimitPolicy` to enforce a zero-trust policy and apply low rate limits based on non-functional requirements.
. Developers onboard services by creating `HTTPRoute` resources representing the endpoints, and apply specific auth policies (e.g., API keys or OAuth) for controlled access.

== Technical considerations

{rhcl} provides Kubernetes-native traffic management in multi-cluster environments.

* It builds on the *Gateway API* (the new Kubernetes standard for Ingress), offering DNS management, TLS certificate lifecycle management, authentication, and rate limiting across all gateway instances in multi-cluster environments. 
* Platform engineers and application developers can collaborate to connect, secure, and protect distributed services and applications. 

image:m3/rhcl-overview.png[width=70%] 

{rhcl}'s policies are applied on the Gateway and HTTPRoute CRs as shown below. 

image:m3/rhcl-policies.png[] 

. *DNS Policy* creates DNS records in DNS providers to enable load balancing across the hybrid cloud. 
. *TLS Policy* manages the TLS certificates lifecycle
. *Rate Limit Policy*  provide rate limiting of requests.
. *Auth Policy* enforces authentication & authorization rules.

With this approach 

* *Platform Engineers* have the right level of control, and  can deploy, manage, observe, and protect services exposed via their gateways. They can confidently allow application developers to use self-service, knowing that endpoints are secured
* *Application developers*, through self-service, can refine policies to their specific needs to protect exposed endpoints, and focus on what is important to them - their applications and code.


=== Environment Setup

To ensure the module can be completed within a short timeframe, specific components have been preconfigured in advance for this workshop:

- The core services and the partner portal have already been deployed on your OpenShift cluster.
- A hosted zone has been created as a subdomain, `travels.{ocp_cluster_workshop_main_domain}`, on AWS Route53 for the applications you wish to manage and secure with `{rhcl}`.

NOTE: 
In this scenario, the applications and services are running on AWS on an OpenShift cluster, and AWS Route 53 is used for DNS purposes. `{rhcl}` also supports other DNS providers, including Azure and Google Cloud, with Core DNS support coming soon.

As part of the workshop, you will also configure the necessary `{rhcl}` Custom Resources (CRs) to connect, secure, and manage the `travel-agency` service.


== Next steps

The next sections walks you through the activities as a Platform Engineer and a Developer. 
